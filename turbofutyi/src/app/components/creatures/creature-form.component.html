<div class="form-page">
  <div class="form-container">
    <div class="form-header">
      <div class="breadcrumb">
        <a routerLink="/creatures">‚Üê Vissza a list√°hoz</a>
      </div>
      <h1>{{ isEditMode() ? 'L√©ny Szerkeszt√©se' : '√öj L√©ny L√©trehoz√°sa' }}</h1>
      <p class="subtitle">
        {{ isEditMode() ? 'M√≥dos√≠tsa a l√©ny adatait' : 'Adjon hozz√° egy √∫j k√ºl√∂nleges l√©nyt a kataszterhez' }}
      </p>
    </div>

    @if (errorMessage()) {
      <div class="error-message">
        {{ errorMessage() }}
      </div>
    }

    <form [formGroup]="creatureForm" (ngSubmit)="onSubmit()" class="creature-form">
      <div class="form-group">
        <label for="name">L√©ny neve <span class="required">*</span></label>
        <input
          id="name"
          type="text"
          formControlName="name"
          class="form-control"
          [class.error]="name?.invalid && name?.touched"
          placeholder="pl. Teleport√°l√≥ Teve, Hangulatv√°lt√≥s Kaktusz"
        />
        @if (name?.invalid && name?.touched) {
          <div class="field-error">
            @if (name?.errors?.['required']) {
              <span>A n√©v megad√°sa k√∂telez≈ë</span>
            }
            @if (name?.errors?.['minlength']) {
              <span>A n√©vnek legal√°bb 3 karakter hossz√∫nak kell lennie</span>
            }
            @if (name?.errors?.['maxlength']) {
              <span>A n√©v maximum 100 karakter hossz√∫ lehet</span>
            }
          </div>
        }
      </div>

      <div class="form-group">
        <label for="category_id">Kateg√≥ria <span class="required">*</span></label>
        <select
          id="category_id"
          formControlName="category_id"
          class="form-control"
          [class.error]="category_id?.invalid && category_id?.touched"
        >
          <option value="">-- V√°lasszon kateg√≥ri√°t --</option>
          @for (category of categories(); track category.id) {
            <option [value]="category.id">{{ category.name }}</option>
          }
        </select>
        @if (category_id?.invalid && category_id?.touched) {
          <div class="field-error">
            <span>A kateg√≥ria kiv√°laszt√°sa k√∂telez≈ë</span>
          </div>
        }
      </div>

      <div class="form-group">
        <label for="description">Le√≠r√°s <span class="required">*</span></label>
        <textarea
          id="description"
          formControlName="description"
          class="form-control textarea"
          [class.error]="description?.invalid && description?.touched"
          placeholder="√çrja le a l√©ny jellemz≈ëit, k√ºl√∂nleges tulajdons√°gait..."
          rows="6"
        ></textarea>
        @if (description?.invalid && description?.touched) {
          <div class="field-error">
            @if (description?.errors?.['required']) {
              <span>A le√≠r√°s megad√°sa k√∂telez≈ë</span>
            }
            @if (description?.errors?.['minlength']) {
              <span>A le√≠r√°snak legal√°bb 10 karakter hossz√∫nak kell lennie</span>
            }
            @if (description?.errors?.['maxlength']) {
              <span>A le√≠r√°s maximum 1000 karakter hossz√∫ lehet</span>
            }
          </div>
        }
        <div class="char-counter">
          {{ description?.value?.length || 0 }} / 1000 karakter
        </div>
      </div>

      <div class="form-actions">
        <a routerLink="/creatures" class="btn-cancel">
          M√©gse
        </a>
        <button
          type="submit"
          class="btn-submit"
          [disabled]="creatureForm.invalid || isLoading()"
        >
          @if (isLoading()) {
            <span class="loading-spinner"></span>
            <span>Ment√©s...</span>
          } @else {
            <span>{{ isEditMode() ? 'üíæ M√≥dos√≠t√°sok ment√©se' : '‚ûï L√©ny l√©trehoz√°sa' }}</span>
          }
        </button>
      </div>
    </form>
  </div>
</div>
